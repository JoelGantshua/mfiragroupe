<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#0f172a">
    <title>Dashboard - AG Groupe</title>
    <link rel="icon" type="image/jpeg" href="assets/images/ag.jpeg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/dashboard.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="assets/images/images.jpg" alt="Mfira Groupe">
            <h2>Mfira Groupe</h2>
            <p>Dashboard</p>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#dashboard" class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span>Tableau de bord</span>
            </a>
            <a href="#contacts" class="nav-item" data-section="contacts">
                <i class="fas fa-envelope"></i>
                <span>Messages Contact</span>
                <span class="badge" id="contacts-badge">0</span>
            </a>
            <a href="#services" class="nav-item" data-section="services">
                <i class="fas fa-cogs"></i>
                <span>Gestion Services</span>
            </a>
            <a href="#notifications" class="nav-item" data-section="notifications">
                <i class="fas fa-bell"></i>
                <span>Notifications</span>
                <span class="badge" id="notifications-badge">0</span>
            </a>
            <a href="#settings" class="nav-item" data-section="settings">
                <i class="fas fa-cog"></i>
                <span>Paramètres</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <a href="index.html" class="nav-item">
                <i class="fas fa-globe"></i>
                <span>Retour au site</span>
            </a>
            <a href="#" class="nav-item" id="logout-btn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Déconnexion</span>
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="topbar">
            <button class="menu-toggle" id="sidebar-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="topbar-right">
                <div class="notifications-dropdown">
                    <button class="notification-btn" id="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="notification-count">0</span>
                    </button>
                    <div class="notifications-menu" id="notifications-menu">
                        <div class="notifications-header">
                            <h3>Notifications</h3>
                            <button id="mark-all-read">Tout marquer comme lu</button>
                        </div>
                        <div class="notifications-list" id="notifications-list">
                            <p class="no-notifications">Aucune notification</p>
                        </div>
                    </div>
                </div>
                <div class="user-profile">
                    <span id="user-email">admin@aggroupe.com</span>
                </div>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="dashboard-section" class="dashboard-section active">
            <div class="page-header">
                <h1>Tableau de bord</h1>
                <p>Vue d'ensemble des formulaires et messages</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="total-contacts">0</h3>
                        <p>Messages reçus</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="total-notifications">0</h3>
                        <p>Notifications</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="unread-contacts">0</h3>
                        <p>Non lus</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="read-contacts">0</h3>
                        <p>Lus</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="total-services">0</h3>
                        <p>Services</p>
                    </div>
                </div>
            </div>

            <div class="recent-section">
                <h2>Messages récents</h2>
                <div id="recent-contacts" class="contacts-list">
                    <p class="no-data">Aucun message pour le moment</p>
                </div>
            </div>
        </section>

        <!-- Contacts Section -->
        <section id="contacts-section" class="dashboard-section">
            <div class="page-header">
                <h1>Messages de contact</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" id="refresh-contacts">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                </div>
            </div>

            <div class="filters">
                <button class="filter-btn active" data-filter="all">Tous</button>
                <button class="filter-btn" data-filter="unread">Non lus</button>
                <button class="filter-btn" data-filter="read">Lus</button>
            </div>

            <div id="contacts-list" class="contacts-list">
                <p class="no-data">Chargement des messages...</p>
            </div>
        </section>

        <!-- Services Management Section -->
        <section id="services-section" class="dashboard-section">
            <div class="page-header">
                <h1>Gestion des Services</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" id="add-service-btn">
                        <i class="fas fa-plus"></i> Ajouter un Service
                    </button>
                    <button class="btn btn-secondary" id="refresh-services">
                        <i class="fas fa-sync-alt"></i> Actualiser
                    </button>
                </div>
            </div>

            <div id="services-list" class="services-list">
                <p class="no-data">Chargement des services...</p>
            </div>
        </section>

        <!-- Notifications Section -->
        <section id="notifications-section" class="dashboard-section">
            <div class="page-header">
                <h1>Notifications</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" id="mark-all-notifications-read">
                        <i class="fas fa-check-double"></i> Tout marquer comme lu
                    </button>
                </div>
            </div>

            <div id="all-notifications-list" class="notifications-list-full">
                <p class="no-data">Aucune notification</p>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="dashboard-section">
            <div class="page-header">
                <h1>Paramètres</h1>
            </div>

            <div class="settings-content">
                <div class="settings-card">
                    <h3>Informations du compte</h3>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-control" id="settings-email" readonly>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Contact Detail Modal -->
    <div class="modal" id="contact-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Détails du message</h2>
                <button class="modal-close" id="close-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="contact-detail-content">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Service Form Modal -->
    <div class="modal" id="service-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="service-modal-title">Ajouter un Service</h2>
                <button class="modal-close" id="close-service-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="service-form">
                    <input type="hidden" id="service-id">
                    
                    <div class="form-group">
                        <label for="service-title">Titre du Service *</label>
                        <input type="text" class="form-control" id="service-title" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-slug">Slug (URL) *</label>
                        <input type="text" class="form-control" id="service-slug" required placeholder="exemple: nouveau-service">
                        <small class="form-text">Utilisé dans l'URL du service</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-icon">Icône Font Awesome *</label>
                        <input type="text" class="form-control" id="service-icon" required placeholder="exemple: fas fa-car">
                        <small class="form-text">Classe d'icône Font Awesome</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-image">URL de l'Image</label>
                        <input type="text" class="form-control" id="service-image" placeholder="exemple: assets/images/image.jpg">
                    </div>
                    
                    <div class="form-group">
                        <label for="service-short-description">Description Courte</label>
                        <textarea class="form-control" id="service-short-description" rows="2"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-description">Description Complète *</label>
                        <textarea class="form-control" id="service-description" rows="4" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="service-features">Caractéristiques (une par ligne)</label>
                        <textarea class="form-control" id="service-features" rows="5" placeholder="Caractéristique 1&#10;Caractéristique 2&#10;..."></textarea>
                        <small class="form-text">Liste les caractéristiques du service, une par ligne</small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="service-display-order">Ordre d'affichage</label>
                            <input type="number" class="form-control" id="service-display-order" value="0" min="0">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="service-type">Type de Service</label>
                            <input type="text" class="form-control" id="service-type" placeholder="exemple: Vehicules">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="service-is-active" checked>
                                <label class="form-check-label" for="service-is-active">Service Actif</label>
                            </div>
                        </div>
                        <div class="form-group col-md-6">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="service-show-homepage" checked>
                                <label class="form-check-label" for="service-show-homepage">Afficher sur la page d'accueil</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancel-service-btn">Annuler</button>
                        <button type="submit" class="btn btn-primary">Enregistrer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="assets/js/supabase-config.js"></script>
    <script src="assets/js/dashboard.js"></script>
</body>
</html>

